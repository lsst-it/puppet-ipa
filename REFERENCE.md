# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

#### Public Classes

* [`ipa`](#ipa): Manages IPA masters, replicas and clients.
* [`ipa::client`](#ipa--client): Manage ipa client
* [`ipa::packetfilter::server`](#ipa--packetfilter--server): Install packet filtering rules for FreeIPA.
* [`ipa::server`](#ipa--server): Manage IPA server install
* [`ipa::server::master`](#ipa--server--master): Manage primary server
* [`ipa::server::replica`](#ipa--server--replica): Manage replica install

#### Private Classes

* `ipa::client::debian`: Ensure that home directories get created on Debian and Ubuntu clients.
* `ipa::server::flushcache`: Manage cache flushing
* `ipa::server::redhat`

### Defined types

* [`ipa::backup`](#ipa--backup): Define ipa::backup

### Plans

* [`ipa::update_host_keys`](#ipa--update_host_keys): Update host keys for a domain-joined node in FreeIPA to match real host
keys.

## Classes

### <a name="ipa"></a>`ipa`

TODO: Allow creation of root zone for isolated networks -- https://www.freeipa.org/page/Howto/DNS_in_isolated_networks
TODO: Class comments.
TODO: Dependencies and metadata updates.
TODO: Variable scope and passing.
TODO: configurable admin username.

#### Parameters

The following parameters are available in the `ipa` class:

* [`domain`](#-ipa--domain)
* [`ipa_role`](#-ipa--ipa_role)
* [`admin_password`](#-ipa--admin_password)
* [`directory_services_password`](#-ipa--directory_services_password)
* [`allow_zone_overlap`](#-ipa--allow_zone_overlap)
* [`no_dnssec_validation`](#-ipa--no_dnssec_validation)
* [`configure_dns_server`](#-ipa--configure_dns_server)
* [`configure_replica_ca`](#-ipa--configure_replica_ca)
* [`configure_ntp`](#-ipa--configure_ntp)
* [`configure_ssh`](#-ipa--configure_ssh)
* [`configure_sshd`](#-ipa--configure_sshd)
* [`custom_dns_forwarders`](#-ipa--custom_dns_forwarders)
* [`domain_join_principal`](#-ipa--domain_join_principal)
* [`domain_join_password`](#-ipa--domain_join_password)
* [`enable_dns_updates`](#-ipa--enable_dns_updates)
* [`enable_hostname`](#-ipa--enable_hostname)
* [`enable_ip_address`](#-ipa--enable_ip_address)
* [`fixed_primary`](#-ipa--fixed_primary)
* [`idstart`](#-ipa--idstart)
* [`idmax`](#-ipa--idmax)
* [`ip_address`](#-ipa--ip_address)
* [`ipa_server_fqdn`](#-ipa--ipa_server_fqdn)
* [`ipa_master_fqdn`](#-ipa--ipa_master_fqdn)
* [`mkhomedir`](#-ipa--mkhomedir)
* [`no_ui_redirect`](#-ipa--no_ui_redirect)
* [`realm`](#-ipa--realm)
* [`adjust_login_defs`](#-ipa--adjust_login_defs)

##### <a name="-ipa--domain"></a>`domain`

Data type: `Stdlib::Fqdn`

(string) The name of the IPA domain to create or join.

##### <a name="-ipa--ipa_role"></a>`ipa_role`

Data type: `Enum['client', 'master', 'replica']`

(string) What role the node will be. Options are 'master', 'replica', and 'client'.

##### <a name="-ipa--admin_password"></a>`admin_password`

Data type: `Optional[String[8]]`

(string) Password which will be assigned to the IPA account named 'admin'.

Default value: `undef`

##### <a name="-ipa--directory_services_password"></a>`directory_services_password`

Data type: `Optional[String[8]]`

(string) Password which will be passed into the ipa setup's parameter named "--ds-password".

Default value: `undef`

##### <a name="-ipa--allow_zone_overlap"></a>`allow_zone_overlap`

Data type: `Boolean`

(boolean) if set to true, allow creating of (reverse) zone even if the zone is already
          resolvable. Using this option is discouraged as it result in later problems with
          domain name. You may have to use this, though, when migrating existing DNS
          domains to FreeIPA.

Default value: `false`

##### <a name="-ipa--no_dnssec_validation"></a>`no_dnssec_validation`

Data type: `Boolean`

(boolean) if set to true, DNSSEC validation is disabled.

Default value: `false`

##### <a name="-ipa--configure_dns_server"></a>`configure_dns_server`

Data type: `Boolean`

(boolean) If true, then the parameter '--setup-dns' is passed to the IPA server installer.
          Also, triggers the install of the required dns server packages.

Default value: `true`

##### <a name="-ipa--configure_replica_ca"></a>`configure_replica_ca`

Data type: `Boolean`

(boolean) If true, then the parameter '--setup-ca' is passed to the IPA replica installer.

Default value: `false`

##### <a name="-ipa--configure_ntp"></a>`configure_ntp`

Data type: `Boolean`

(boolean) If false, then the parameter '--no-ntp' is passed to the IPA client and server
          installers.

Default value: `true`

##### <a name="-ipa--configure_ssh"></a>`configure_ssh`

Data type: `Boolean`

(boolean) If false, then the parameter '--no-ssh' is passed to the IPA client and server
          installers.

Default value: `true`

##### <a name="-ipa--configure_sshd"></a>`configure_sshd`

Data type: `Boolean`

(boolean) If false, then the parameter '--no-sshd' is passed to the IPA client and server
          installers.

Default value: `true`

##### <a name="-ipa--custom_dns_forwarders"></a>`custom_dns_forwarders`

Data type: `Array[String]`

(array[string]) Each element in this array is prefixed with '--forwarder '
                and passed to the IPA server installer.

Default value: `[]`

##### <a name="-ipa--domain_join_principal"></a>`domain_join_principal`

Data type: `String[1]`

(string) The principal (usually username) used to join a client or replica to the IPA domain.

Default value: `'admin'`

##### <a name="-ipa--domain_join_password"></a>`domain_join_password`

Data type: `Optional[String[1]]`

(string) The password for the domain_join_principal.

Default value: `$directory_services_password`

##### <a name="-ipa--enable_dns_updates"></a>`enable_dns_updates`

Data type: `Boolean`

(boolean) If true, then the parameter '--enable-dns-updates' is passed to the IPA installer.

Default value: `false`

##### <a name="-ipa--enable_hostname"></a>`enable_hostname`

Data type: `Boolean`

(boolean) If true, then the parameter '--hostname' is populated with the parameter 'ipa_server_fqdn'
          and passed to the IPA installer.

Default value: `true`

##### <a name="-ipa--enable_ip_address"></a>`enable_ip_address`

Data type: `Boolean`

(boolean) If true, then the parameter '--ip-address' is populated with the parameter 'ip_address'
          and passed to the IPA installer.

Default value: `false`

##### <a name="-ipa--fixed_primary"></a>`fixed_primary`

Data type: `Boolean`

(boolean) If true, then the parameter '--fixed-primary' is passed to the IPA installer.

Default value: `false`

##### <a name="-ipa--idstart"></a>`idstart`

Data type: `Integer[10000]`

(integer) From the IPA man pages: "The starting user and group id number".

Default value: `(fqdn_rand('10737') + 10000`

##### <a name="-ipa--idmax"></a>`idmax`

Data type: `Variant[Integer,Undef]`

(integer) From the IPA man pages: "The max value for the IDs range (default: idstart+199999)".

Default value: `undef`

##### <a name="-ipa--ip_address"></a>`ip_address`

Data type: `Optional[Stdlib::IP::Address]`

(string) IP address to pass to the IPA installer.

Default value: `undef`

##### <a name="-ipa--ipa_server_fqdn"></a>`ipa_server_fqdn`

Data type: `String`

(string) Actual fqdn of the IPA server or client.

Default value: `fact('networking.fqdn')`

##### <a name="-ipa--ipa_master_fqdn"></a>`ipa_master_fqdn`

Data type: `Optional[Stdlib::Fqdn]`

(string) FQDN of the server to use for a client or replica domain join.

Default value: `undef`

##### <a name="-ipa--mkhomedir"></a>`mkhomedir`

Data type: `Boolean`

(boolean) If true, then the parameter '--mkhomedir' is passed to the IPA server and client
installers.

Default value: `true`

##### <a name="-ipa--no_ui_redirect"></a>`no_ui_redirect`

Data type: `Boolean`

(boolean) If true, then the parameter '--no-ui-redirect' is passed to the IPA server installer.

Default value: `false`

##### <a name="-ipa--realm"></a>`realm`

Data type: `Optional[Stdlib::Fqdn]`

(string) The name of the IPA realm to create or join.

Default value: `undef`

##### <a name="-ipa--adjust_login_defs"></a>`adjust_login_defs`

Data type: `Boolean`

(boolean) Adjust UID_MAX and GID_MAX in login.defs. Without this newer server installers fail. Default false.

Default value: `false`

### <a name="ipa--client"></a>`ipa::client`

Manage ipa client

#### Parameters

The following parameters are available in the `ipa::client` class:

* [`package_name`](#-ipa--client--package_name)
* [`force_join`](#-ipa--client--force_join)

##### <a name="-ipa--client--package_name"></a>`package_name`

Data type: `Array[String]`

The name of the package(s) to install.

Default value: `undef`

##### <a name="-ipa--client--force_join"></a>`force_join`

Data type: `Boolean`

Force the client to join the domain even if it is already joined.

Default value: `false`

### <a name="ipa--packetfilter--server"></a>`ipa::packetfilter::server`

Install packet filtering rules for FreeIPA.

#### Parameters

The following parameters are available in the `ipa::packetfilter::server` class:

* [`allow_address_ipv4`](#-ipa--packetfilter--server--allow_address_ipv4)
* [`allow_address_ipv6`](#-ipa--packetfilter--server--allow_address_ipv6)

##### <a name="-ipa--packetfilter--server--allow_address_ipv4"></a>`allow_address_ipv4`

Data type: `Variant[Stdlib::IP::Address::V4,Array[Stdlib::IP::Address::V4]]`

IPv4 address to allow access from.

Default value: `'127.0.0.1'`

##### <a name="-ipa--packetfilter--server--allow_address_ipv6"></a>`allow_address_ipv6`

Data type: `Variant[Stdlib::IP::Address::V6,Array[Stdlib::IP::Address::V6]]`

IPv6 address to allow access from.

Default value: `'::1'`

### <a name="ipa--server"></a>`ipa::server`

Manage IPA server install

#### Parameters

The following parameters are available in the `ipa::server` class:

* [`package_name`](#-ipa--server--package_name)

##### <a name="-ipa--server--package_name"></a>`package_name`

Data type: `Array[String]`

The name of the package(s) to install.

Default value: `undef`

### <a name="ipa--server--master"></a>`ipa::server::master`

Manage primary server

### <a name="ipa--server--replica"></a>`ipa::server::replica`

Manage replica install

## Defined types

### <a name="ipa--backup"></a>`ipa::backup`

Backup FreeIPA from cron

#### Parameters

The following parameters are available in the `ipa::backup` defined type:

* [`title`](#-ipa--backup--title)
* [`type`](#-ipa--backup--type)
* [`timestamp`](#-ipa--backup--timestamp)
* [`monthday`](#-ipa--backup--monthday)
* [`weekday`](#-ipa--backup--weekday)
* [`hour`](#-ipa--backup--hour)
* [`minute`](#-ipa--backup--minute)

##### <a name="-ipa--backup--title"></a>`title`

The resource title is used as part of the the name for the cronjob.

##### <a name="-ipa--backup--type"></a>`type`

Data type: `Enum['full','data']`

Backup type. Either 'full' (offline) or 'data' (online).

##### <a name="-ipa--backup--timestamp"></a>`timestamp`

Data type: `Boolean`

Keep the default timestamp in the backup directory. Valid values are true
(default) and false. Set this to false if you have and external system (e.g.
bacula) that fetches the backups periodically and handles versioning on its
own.

Default value: `true`

##### <a name="-ipa--backup--monthday"></a>`monthday`

Data type: `Variant[Array[String], Array[Integer[1-31]], String, Integer[1-31]]`

Standard parameter for the cron resource.

Default value: `'*'`

##### <a name="-ipa--backup--weekday"></a>`weekday`

Data type: `Variant[Array[String], Array[Integer[0-7]],  String, Integer[0-7]]`

Standard parameter for the cron resource.

Default value: `'*'`

##### <a name="-ipa--backup--hour"></a>`hour`

Data type: `Variant[Array[String], Array[Integer[0-23]], String, Integer[0-23]]`

Standard parameter for the cron resource.

##### <a name="-ipa--backup--minute"></a>`minute`

Data type: `Variant[Array[String], Array[Integer[0-59]], String, Integer[0-59]]`

Standard parameter for the cron resource

## Plans

### <a name="ipa--update_host_keys"></a>`ipa::update_host_keys`

Useful when real keys and keys in IPA device account have gone
  out of sync, e.g. due to rebuilding the server from a snapshot.

  This gets a kerberos ticket from the IPA server first, then gathers
  the SSH keys from IPA clients from their SSH facts, then runs appropriate
  "ipa host-mod" commands for each IPA client on the IPA server.

  Note that it is assumed that the IPA client host name is equal to the $::fqdn
  fact.

#### Parameters

The following parameters are available in the `ipa::update_host_keys` plan:

* [`ipa_clients`](#-ipa--update_host_keys--ipa_clients)
* [`ipa_server`](#-ipa--update_host_keys--ipa_server)
* [`ipa_user`](#-ipa--update_host_keys--ipa_user)
* [`ipa_password`](#-ipa--update_host_keys--ipa_password)
* [`noop`](#-ipa--update_host_keys--noop)

##### <a name="-ipa--update_host_keys--ipa_clients"></a>`ipa_clients`

Data type: `TargetSpec`

One of more IPA clients whose host keys to puload

##### <a name="-ipa--update_host_keys--ipa_server"></a>`ipa_server`

Data type: `TargetSpec`

A host which has the "ipa" tools installed. Not necessarily an IPA server.

##### <a name="-ipa--update_host_keys--ipa_user"></a>`ipa_user`

Data type: `String`

An IPA user with permission to run "ipa host-mod".

##### <a name="-ipa--update_host_keys--ipa_password"></a>`ipa_password`

Data type: `String`

IPA user's password

##### <a name="-ipa--update_host_keys--noop"></a>`noop`

Data type: `Boolean`

If true then only imulate what would be done

Default value: `true`

